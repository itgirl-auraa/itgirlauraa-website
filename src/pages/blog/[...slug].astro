---
import Layout from '../../layouts/Layout.astro';
import { getCollection } from 'astro:content';

export async function getStaticPaths() {
  const posts = await getCollection('posts');
  return posts.map(post => ({
    params: { slug: post.slug },
    props: { post },
  }));
}

const { post } = Astro.props;
const { Content } = await post.render();

const allPosts = await getCollection('posts');
const relatedPosts = allPosts
  .filter(p => p.data.category === post.data.category && p.slug !== post.slug)
  .slice(0, 3);
---

<Layout title={`${post.data.title} – Glow Journal`} description={post.data.description}>

  <article class="max-w-3xl mx-auto px-5 sm:px-6 lg:px-0 py-12">

    <!-- Post Header -->
    <header class="mb-8 text-center">
      <p class="text-sm text-[#8b6f63] mb-1 tracking-wide uppercase">
        {new Date(post.data.date).toLocaleDateString('en-US', {
          month: 'long',
          day: 'numeric',
          year: 'numeric',
        })} • {post.data.category}
      </p>

      <h1 class="font-display text-4xl sm:text-5xl text-[#3a2d2d] leading-tight tracking-tight max-w-3xl mx-auto mb-3">
        {post.data.title}
      </h1>

      {post.data.description && (
        <p class="text-lg text-[#5c4b45] max-w-2xl mx-auto">
          {post.data.description}
        </p>
      )}
    </header>

    <!-- Featured Image -->
    {post.data.image && (
      <div class="mb-10">
        <img 
          src={post.data.image} 
          alt={post.data.title} 
          class="w-full max-h-[420px] object-cover rounded-xl border border-[#eae2d6]" 
        />
      </div>
    )}

    <!-- Blog Content -->
    <div class="prose prose-base sm:prose-lg leading-relaxed max-w-none
                prose-headings:text-[#3a2d2d] prose-headings:mb-3
                prose-p:text-[#4b2f2f] prose-p:mb-3
                prose-a:text-[#9b6b4f]
                prose-img:rounded-xl
                prose-blockquote:border-l-4
                prose-blockquote:border-[#9b6b4f]
                prose-blockquote:pl-4
                prose-blockquote:text-[#5c4b45]
                prose-strong:text-[#3a2d2d]
                [&>*]:my-2 [&>hr]:my-4">
      <Content />
    </div>

    

    <!-- Author Bio -->
    <footer class="mt-12 border-t border-[#eae2d6] pt-6">
      <div class="flex items-center gap-4">
        <img 
          src="/uploads/divya.jpg" 
          alt="Divya" 
          class="w-14 h-14 rounded-full object-cover" 
        />
        <div>
          <h3 class="font-display text-lg text-[#3a2d2d] mb-1">Written by Divya</h3>
          <p class="text-[#5c4b45] text-sm leading-snug">
            Founder of <strong>It Girl Auraa</strong>, a digital destination for soft living, glow-up rituals, and curated lifestyle picks for the modern woman becoming her best self.
          </p>
        </div>
      </div>
    </footer>

  </article>
</Layout>
